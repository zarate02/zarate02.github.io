<!doctype html>
<html>
  <head>
  <title>
    
      Nestjs - 3. 외부환경파일 | Zaimy
    
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="/assets/css/syntax.css">
  <!-- Use Atom -->
  <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Zaimy" />
  <!-- RSS-v2.0
  <link href="/rss-feed.xml" type="application/rss+xml" rel="alternate" title="Zaimy | Development And Investment Blog"/>
  //-->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Source+Code+Pro">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
  <!-- Google Analytics -->
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-112060364-2', 'auto');
  ga('send', 'pageview');
</script>

  <!-- Use Jekyll SEO plugin -->
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Nestjs - 3. 외부환경파일 | Zaimy</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Nestjs - 3. 외부환경파일" />
<meta name="author" content="zaimy" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="3. 외부환경파일 1) 설치 @nestjs/config : 설정 파일을 외부에서 가져오기 위한 nestjs에서 제공되는 모듈 cross-env : os에 종속되지 않고, 플랫폼 표준화를 하기위해 필요한 라이브러리 joi : 형식에 대한 유효성 검사" />
<meta property="og:description" content="3. 외부환경파일 1) 설치 @nestjs/config : 설정 파일을 외부에서 가져오기 위한 nestjs에서 제공되는 모듈 cross-env : os에 종속되지 않고, 플랫폼 표준화를 하기위해 필요한 라이브러리 joi : 형식에 대한 유효성 검사" />
<link rel="canonical" href="http://localhost:4000/nest-003" />
<meta property="og:url" content="http://localhost:4000/nest-003" />
<meta property="og:site_name" content="Zaimy" />
<meta property="og:image" content="http://localhost:4000/nest_logo.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-06-10T00:00:00+09:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/nest_logo.png" />
<meta property="twitter:title" content="Nestjs - 3. 외부환경파일" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"zaimy"},"dateModified":"2022-06-10T00:00:00+09:00","datePublished":"2022-06-10T00:00:00+09:00","description":"3. 외부환경파일 1) 설치 @nestjs/config : 설정 파일을 외부에서 가져오기 위한 nestjs에서 제공되는 모듈 cross-env : os에 종속되지 않고, 플랫폼 표준화를 하기위해 필요한 라이브러리 joi : 형식에 대한 유효성 검사","headline":"Nestjs - 3. 외부환경파일","image":"http://localhost:4000/nest_logo.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/nest-003"},"url":"http://localhost:4000/nest-003"}</script>
<!-- End Jekyll SEO tag -->

</head>

  <body>
    <div class="container">
      <header class="site-header">
  <h3 class="site-title">
    <a href="/">Zaimy</a>
  </h3>
  <nav class="menu-list">
    
      <a href="/development" class="menu-link">Development</a>
    
      <a href="/investment" class="menu-link">Investment</a>
    
      <a href="/about" class="menu-link">About</a>
    
      <a href="/contact" class="menu-link">Contact</a>
    
    
      <a href="https://twitter.com/paululele" class="menu-link" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
    
  </nav>
  <div class="dropdown">
    <button class="dropbtn"><i class="fa fa-bars" aria-hidden="true"></i></button>
    <div class="dropdown-content">
      
        <a href="/development" class="menu-link">Development</a>
      
        <a href="/investment" class="menu-link">Investment</a>
      
        <a href="/about" class="menu-link">About</a>
      
        <a href="/contact" class="menu-link">Contact</a>
      
      
        <a href="https://twitter.com/paululele" class="menu-link" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
      
    </div>
  </div>
</header>

      <div class="content-wrapper">
        <div class="post-content">
  <h1>
    Nestjs - 3. 외부환경파일
  </h1>
  
    <span class="post-date">
  Written on
  
  June
  10th,
  2022
  by
  
    zaimy
  
</span>

  
  
    <div class="featured-image">
      <img src="/assets/img/nest_logo.png">
    </div>
  
  <article>
    <h1 id="3-외부환경파일">3. 외부환경파일</h1>
<hr />
<h2 id="1-설치">1) 설치</h2>
<ul>
  <li>@nestjs/config : 설정 파일을 외부에서 가져오기 위한 nestjs에서 제공되는 모듈</li>
  <li>cross-env : os에 종속되지 않고, 플랫폼 표준화를 하기위해 필요한 라이브러리</li>
  <li>joi : 형식에 대한 유효성 검사</li>
</ul>

<p>아래와같이 설치한다</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yarn add @nestjs/config 
yarn add cross-env 
yarn add joi
</code></pre></div></div>
<hr />
<h2 id="2-cross-env로-환경변수-주입">2) cross-env로 환경변수 주입</h2>
<p>package.json에 cross-env NODE_ENV=실행환경 추가</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"start:dev": "cross-env NODE_ENV=dev nest start --watch",
"start:prod": "cross-env NODE_ENV=prod node dist/main",
</code></pre></div></div>
<hr />
<h2 id="3-nestjsconfig로-환경변수-호출">3) @nestjs/config로 환경변수 호출</h2>
<p>app.module.ts 에 config모듈을 import<br />
validationSchema 를 통해 문법을 검사</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import { ConfigModule } from '@nestjs/config';
import * as Joi from 'joi';
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>imports: [
	ConfigModule.forRoot({
		isGlobal: true,
		envFilePath: process.env.NODE_ENV === 'dev' ? '.env.dev' : '.env.test',
		ignoreEnvFile: process.env.NODE_ENV === 'prod',
		validationSchema: Joi.object({
			NODE_ENV: Joi.string().valid('dev', 'prod').required(),
			DB_HOST: Joi.string().required(),
			DB_PORT: Joi.string().required(),
			DB_USERNAME: Joi.string().required(),
			DB_PASSWORD: Joi.string().required(),
			DB_SID: Joi.string().required(),
		}),
    }),
]
</code></pre></div></div>
<p>최상위 디렉토리에 .env.dev 파일생성</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DB_HOST=IP
DB_PORT=포트
DB_USERNAME=계정
DB_PASSWORD=비밀번호
DB_SID=sid
</code></pre></div></div>
<hr />
<h2 id="4-생성한-환경설정-적용">4) 생성한 환경설정 적용</h2>
<p>예제로 데이터베이스 설정 항목들을 외부환경설정에거 가져옴</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TypeOrmModule.forRoot({
	type: 'oracle',

	host: process.env.DB_HOST,
	port: +process.env.DB_PORT,
	username: process.env.DB_USERNAME,
	password: process.env.DB_PASSWORD,
	sid: process.env.DB_SID,
	
	entities: [cm_dsplist_act, CtCtlproc, AiFlashcd],
	synchronize: false,
	// logging: true,
}),
</code></pre></div></div>

  </article>
  
    <div class="post-share">
  <div class="post-date">Feel free to share!</div>
  <div class="sharing-icons">
    <a href="https://twitter.com/intent/tweet?text=Nestjs - 3. 외부환경파일&amp;url=/nest-003" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
    <a href="https://www.facebook.com/sharer/sharer.php?u=/nest-003&amp;title=Nestjs - 3. 외부환경파일" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a>
  </div>
</div>

  
  
    <div class="related">
  <h2>You may also enjoy...</h2>
  
  <ul class="related-posts">
    
      
        
          <li>
            <h3>
              <a href="/nest-004">
                <div class="related-thumbnail">
                  
                    <img src="http://localhost:4000/assets/img/nest_logo.png">
                  
                </div>
                <div class="related-title">
                  Nestjs - 4. 로그
                </div>
                <!--<small>June 10, 2022</small>-->
              </a>
            </h3>
          </li>
          
        
      
        
        
      
    
  </ul>
</div>

  
  
</div>

      </div>
      <footer class="footer">
  
    <a href="https://twitter.com/paululele" class="menu-link" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
  
  <div class="footer-description"><a href="/">Zaimy | Development And Investment Blog by zaimy</a></div>
</footer>

    </div>
  </body>
</html>
